@*
 * Copyright 2019 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import utils.FormMappingsConstants._
@import uk.gov.hmrc.play.views.html.helpers
@import config.PbikContext
@import config.AppConfig
@import config.LocalFormPartialRetriever

@(errorMessage:String,
 taxYearRange:TaxYearRange,
 isCurrentTaxYear:String= "", code:Int = 0,
 pageHeading:String ="An error has occurred",
 backLink:String= "overview", empRef: Option[EmpRef])(implicit request:Request[_],
                              context: PbikContext, messages: Messages,
                                externalURLs: ExternalUrls,
                                config: AppConfig,
                                localFormPartialRetriever: LocalFormPartialRetriever)

@parentTemplate(pageTitle = messages("Service.title"), Some(taxYearRange), Some(empRef.toString)) {

    @isCurrentTaxYear match {
        case utils.FormMappingsConstants.CY => {<h1 id="title">@messages(pageHeading,taxYearRange.cyminus1.toString, taxYearRange.cy.toString)</h1>}
        case utils.FormMappingsConstants.CYP1 => {<h1 id="title">@messages(pageHeading, taxYearRange.cy.toString, taxYearRange.cyplus1.toString)</h1>}
        case _ if(code >= 0) => {<h1 id="title">@messages("ServiceMessage." + (code) + ".h1")</h1>}
        case _ => {<h1 id="title">@messages(errorMessage + "", "", "")</h1>}
    }

    <p class="lede-para text">
     @isCurrentTaxYear match {
            case utils.FormMappingsConstants.CY => {@Html(messages(errorMessage + isCurrentTaxYear , taxYearRange.cyminus1.toString, taxYearRange.cy.toString))}
            case utils.FormMappingsConstants.CYP1 => {@Html(messages(errorMessage + isCurrentTaxYear , taxYearRange.cy.toString, taxYearRange.cyplus1.toString))}
            case _ if(code == 63091) => {

                @Html(messages("ServiceMessage." + (code)))

            }
            case _ if(code == 63088 || code == 64989 || code == 10003)  => {

                @Html(messages("ServiceMessage." + (code) + ".1"))

            }
            case _ => {@Html(messages(errorMessage))}
        }
    </p>

    <p class="text">
        @if(code == 63088 || code == 64989 || code == 10003) {

            @Html(messages("ServiceMessage." + (code) + ".2"))
        }
    </p>


    @code match {
        case 63082 => {<a id="link-try-again" href='javascript: window.history.go(-1)'>@messages("Service.tryagain")</a>}
        case 63085 => {<a id="link-add-another" href='javascript: window.history.go(-1)'>@messages("Service.excludeanotheremployee")</a>}
        case 63090 => {<a id="link-add-another" href='javascript: window.history.go(-1)'>@messages("Service.excludeanotheremployee")</a>}
        case 63092 => {<a id="link-add-another" href='javascript: window.history.go(-1)'>@messages("Service.excludeanotheremployee")</a>}
        case _ => {}
    }

    <p>
        @backLink match {
            case _ if(code != 0 && code != 10001 && code != 65176 && code!=65355)=>{
                <a id="link-back" onclick="gaEventLinkOverview()" href='@routes.HomePageController.onPageLoad'>
                    @messages("Service.back.overview")</a>}
            case _ => {
                <a id="link-back" onclick="gaEventLinkOverview()" href='@routes.HomePageController.onPageLoad'>
                    @messages("Service.back.overview")</a>
            }
        }
    </p>

}
