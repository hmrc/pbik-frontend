@*
 * Copyright 2019 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import play.api.Play
@import layouts.govuk_template
@import uk.gov.hmrc.play.views.html.layouts
@import uk.gov.hmrc.play.views.html.{layouts => uiLayouts}
@import config.AppConfig
@import config.PbikContext
@import config.LocalFormPartialRetriever



@(title: String,
  headerNav: Option[views.helpers.HeaderNav] = None,
  sidebarLinks: Option[Html] = None,
  sidebarClass: Option[String] = None,
  userLoggedIn: Boolean = false,
  supportLinkEnabled: Boolean = true,
  serviceInfoContent: Option[Html] = None,
  contentHeader: Option[Html] = None,
  footerLinks: Option[Html] = None,
  linkElement: Option[Html] = None,
  headScripts: Option[Html] = None,
  scriptElement: Option[Html] = None,
  mainConfig: MainConfig = MainConfig(),
  includeGridWrapper: Boolean = false,
  gaCalls: Option[(String,String) => Html] = None,
  isUserResearchBannerVisible:Boolean = true)(mainContent: Html)(implicit request : Request[_],
                                                                               context: PbikContext,
                                                                               messages: Messages,
                                                                                config: AppConfig,
                                                localFormPartialRetriever: LocalFormPartialRetriever)

@head = {
@uiLayouts.head(linkElement, headScripts)
}

@insideHeader = {
    @if(headerNav) {
        @uiLayouts.header_nav(headerNav.get.title,headerNav.get.titleLink, headerNav.get.showBetaLink, headerNav.get.links)
    }
}

@urToggle = @{
  true
}

@afterHeader = @{

    if(isUserResearchBannerVisible && urToggle) {
        helpers.fullWidthBanner(
        messages("urbanner.message.text"),
        config.urBannerLink
    )
}
else HtmlFormat.empty

}

@actingAttorneyBanner = {

}

@betaBanner = {

}

@serviceInfo = {
    @layouts.serviceInfo(betaBanner,
        includeGridWrapper,
        serviceInfoContent,
        includeHMRCBranding=true,
        setLang=messages.lang.code)
}

@getHelpForm = {
    @localFormPartialRetriever.getPartialContent(config.reportAProblemPartialUrl)(request)
}


@sidebar = {
    @if(sidebarLinks.isDefined) {
        @layouts.sidebar(sidebarLinks.get, sidebarClass)
    }
}

@article = {

    @layouts.article(mainContent, includeGridWrapper, Some(""))

}

@mainContentHeader = {
    @if( contentHeader.isDefined ) {
        @layouts.main_content_header(contentHeader.get)
    }
}

@content = {
    @layouts.main_content(article,
        mainConfig.maybeMainClass,
        mainConfig.maybeMainDataAttributes,
        mainContentHeader,
        serviceInfo,
        actingAttorneyBanner,
        sidebar,
        getHelpForm)
}

@footerTop = {

}

@bodyEnd = {

    @uiLayouts.footer(analyticsToken = config.analyticsToken,
        analyticsHost = config.analyticsHost,
        ssoUrl = config.ssoUrl,
        scriptElem = scriptElement,
        gaCalls = gaCalls)

<link rel="stylesheet" href='@routes.Assets.versioned("stylesheets/pbik.css")' media="screen" type="text/css" />
<link rel="stylesheet" href='@routes.Assets.versioned("stylesheets/urBanner.css")' media="screen" type="text/css" />
<script type="text/javascript" src='@routes.Assets.versioned("javascripts/pbik.js")'></script>
<script type="text/javascript" src='@routes.Assets.versioned("javascripts/urBanner.js")'></script>
}

@govuk_template(Some(title), None)(head, bodyEnd, insideHeader, afterHeader, footerTop, Some(uiLayouts.footer_links()), headerNav.isDefined)(content)
